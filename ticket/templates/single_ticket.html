{% extends 'base.html' %}
{% block content %}
	<div class="container text-center">
		{% if ticket %}
			<h1>{{ ticket.title }}</h1>
			<p>{{ ticket.progress }}</p>
			<p>{{ ticket.ticket_type }}</p>
			<p>{{ ticket.body }}</p>
			<p>Created by: {{ ticket.author }}</p>
			<p>Date: {{ ticket.pub_date }}</p>
			<p>Upvotes: {{ ticket.upvotes }}</p>
			
	    {% endif %}
	    {% if ticket.ticket_type == 'Feature' %}
			<h5>Upvote for Â£5.00</h5>
			<form action="{% url 'show_single' ticket.id %}" method="post">
	  			{% csrf_token %}
				<script src="https://checkout.stripe.com/checkout.js" class="stripe-button"
			    data-key={{ key }}
			    data-description="Payment"
			    data-amount="500"
			    data-currency="gbp"
			    data-locale="auto">
				</script>
			</form>
		{% else %}
			<a href="{% url 'checkout' ticket.id %}">Upvote</a>
		{% endif %}
	</div>
	<div class="container text-center">
	{% for comment in comments %}
	    <div class="comment">
	        <div class="date">{{ comment.created_date }}</div>
	        <strong>{{ comment.author }}</strong>
	        <strong>{{ comment.date }}</strong>
	        <p>{{ comment.text|linebreaks }}</p>
	    </div>
	{% empty %}
    	<p>No comments here yet :(</p>
	{% endfor %}
		<div class="text-center">
		    <span class="step-links">
		        {% if comments.has_previous %}
		        	
		            <a href="?page=1">&laquo; first</a>
		            <a href="?page={{ comments.previous_page_number }}">previous</a>
		        {% endif %}
		        	
		        <span class="current">
		            Page {{ comments.number }} of {{ comments.paginator.num_pages }}.
		        </span>

		        {% if comments.has_next %}
		            <a href="?page={{ comments.next_page_number }}">next</a>
		            <a href="?page={{ comments.paginator.num_pages }}">last &raquo;</a>
		        {% endif %}
		    </span>
		</div>
	{% if user.is_authenticated %}
		<a href="{% url 'add_comment' pk=ticket.pk %}">Add comment</a>
	{% endif %}
	<br>
	<a href="{% url 'home' %}">Back</a>
	</div>
{% endblock %}